(this["webpackJsonpsudoku-chess2-client"]=this["webpackJsonpsudoku-chess2-client"]||[]).push([[0],{114:function(e,t,n){},144:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(0),c=n.n(a),o=n(35),i=n.n(o),s=n(28),u=n(4),l=n(7),d=n(5),j=(n(84),function(e){return"string"===typeof e.action?Object(r.jsx)(s.b,{className:"menu-button",to:e.action,children:e.text?e.text:e.children}):Object(r.jsx)("button",{className:"menu-button",onClick:e.action,children:e.text?e.text:e.children})}),b=(n(86),function(e){var t=Object(a.useState)(!1),n=Object(d.a)(t,2),o=n[0],i=n[1];Object(a.useEffect)((function(){i(!0)}),[]);var s=function(){i(!1),setTimeout((function(){e.handleModal()}),e.timer)};return Object(r.jsx)("div",{className:"\n      modal-container \n      ".concat(o?"show":"hide"," \n      "),style:{transitionDuration:e.timer+"ms"},"data-modal":"modal",children:c.a.Children.map(e.children,(function(e){return c.a.isValidElement(e)?c.a.cloneElement(e,{handleHide:s}):e}))})}),f=function(e){return e.handleModal?Object(r.jsxs)("div",{id:"login",onClick:e.handleModal,children:[" ","Login"," "]}):Object(r.jsx)("div",{id:"login",children:" Signed in "})},h=n(21),O=(n(87),n(32)),m=n.n(O),p=n(46),v=(n(37),function(e,t){return{type:"SET_BOARD",payload:{board:e,isPlayer:t}}}),x=(n(90),Object(l.b)(null,{signInSomeAuth:function(e){return{type:"SET_UID",payload:{uid:e}}}})((function(e){return Object(r.jsxs)("div",{className:"modal-content",children:[Object(r.jsxs)("div",{className:"modal-header",children:[Object(r.jsx)("button",{className:"fa fa-arrow-left",onClick:e.handleHide}),Object(r.jsx)("h4",{children:"Login"})]}),Object(r.jsx)("div",{className:"modal-body",children:Object(r.jsxs)(j,{action:function(){return function(t){var n=function(){switch(t){case"GOOGLE":return new h.a.auth.GoogleAuthProvider;default:window.alert("Sorry there was an error with the authetication process")}}();n&&h.a.auth().signInWithPopup(n).then((function(t){var n,r=null===(n=h.a.auth().currentUser)||void 0===n?void 0:n.uid;r?(e.signInSomeAuth(r),e.handleHide()):console.warn("Did not receive uid")})).catch((function(e){window.alert("Sorry there was an error with the Google provier process"),console.log(e)})).finally(e.handleHide)}("GOOGLE")},children:[Object(r.jsx)("span",{className:"menu-button-icon fa fa-google"})," Google"]})})]})}))),y=(n(91),function(){var e=Object(a.useState)(!1),t=Object(d.a)(e,2),n=t[0],c=t[1],o=Object(l.c)((function(e){return{uid:e.user.uid}})).uid,i=function(){c(!n)};return Object(r.jsxs)("div",{className:"menu-container",children:[n?Object(r.jsx)(b,{timer:400,handleModal:i,children:Object(r.jsx)(x,{handleHide:function(){console.warn("LoginMenu failed to load proper props")}})}):null,Object(r.jsxs)("div",{className:"menu-header",children:[Object(r.jsx)("h1",{children:" SuGoKu "}),Object(r.jsx)(f,{handleModal:null===o&&i})]}),Object(r.jsx)(j,{action:"/create",text:"Create Game"}),Object(r.jsx)(j,{action:"/join",text:"Join Game"}),Object(r.jsx)(j,{action:"/replay",text:"Replay Game"})]})}),g=Object(l.b)((function(e){return{uid:e.user.uid}}),{newGame:function(e,t){return function(n,r){var a=r().user.conn;console.log(a),a.emit("NEW_GAME",{size:e,uid:t},function(){var e=Object(p.a)(m.a.mark((function e(t){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:r=e.sent,n(v(r,1));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}})((function(e){var t=function(t){console.log(t),e.newGame(t,e.uid?e.uid:"Anon")};return Object(r.jsxs)("div",{className:"menu-container",children:[Object(r.jsxs)("div",{className:"menu-header",children:[Object(r.jsx)("h1",{children:" Create Game "}),Object(r.jsx)("h4",{children:" Select Board Size "})]}),Object(r.jsx)(j,{action:function(){return t(81)},text:"9x9"}),Object(r.jsx)(j,{action:function(){return t(256)},text:"14x14"})]})})),N=Object(l.b)((function(e){return{conn:e.user.conn,uid:e.user.uid}}),{joinGame:function(e,t){return function(n,r){r().user.conn.emit("JOIN_GAME",{_id:e,uid:t},function(){var e=Object(p.a)(m.a.mark((function e(t){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:r=e.sent,n(v(r,2));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}})((function(e){var t=Object(a.useState)([]),n=Object(d.a)(t,2),c=n[0],o=n[1];Object(a.useEffect)((function(){e.conn.emit("GET_GAMES",null,(function(e){o(e)}))}),[e.conn]);return Object(r.jsxs)("div",{className:"menu-container",children:[Object(r.jsx)("h1",{children:"JoinGame"}),c.map((function(t,n){return Object(r.jsx)(j,{text:t,action:function(){return function(t){e.joinGame(t,e.uid?e.uid:"Anon")}(t)}},n)}))]})})),S=n(6),A=n(31),T=function(e){var t=Object(a.useState)(e.value),n=Object(d.a)(t,2),c=n[0],o=n[1],i=function(t){"Enter"===t.key&&e.handleTurn(e.index,c)};return Object(a.useEffect)((function(){var e=document.getElementsByClassName("infocus");e[0]&&e[0].addEventListener("keyup",i)}),[c]),Object(r.jsx)("input",{className:"input-cell ".concat(0===e.value?"infocus":"nofocus"),type:"number",min:0,max:e.n*e.n,value:e.value>0?Number(e.value).toString():Number(c).toString(),onChange:function(e){var t=parseInt(e.currentTarget.value);o(t)},disabled:e.value>0})},w=n(72),E={initGrid:function(e,t){for(var n=t*t,r=new Array(n*n).fill(0),a=new Array(n*n).fill(0),c=0;c<e.length;c++){var o=e[c];r[o.index]=o.value,a[o.index]=o.player;var i=E.autoComplete(o.index,r,3);if(console.log(i),i){var s,u=Object(w.a)(i);try{for(u.s();!(s=u.n()).done;){var l=s.value;0!==l.value&&(r[l.index]=l.value,a[l.index]=o.player)}}catch(d){u.e(d)}finally{u.f()}}}return{values:r,players:a}},getRow:function(e,t){var n=t*t,r=~~(e/n)*n;return Array.from(Array(n).keys()).map((function(e){return r+e}))},getCol:function(e,t){var n=t*t,r=e%n;return Array.from(Array(n).keys()).map((function(e){return r+n*e}))},getBox:function(e,t){for(var n=t*t,r=~~(e/(n*t))*n*t+~~(e%n/t)*t,a=[],c=0;c<t;c++)for(var o=0;o<t;o++)a.push(r+o+c*n);return a},getGroupSet:function(e,t,n){var r=E.getBox(e,n).concat(E.getCol(e,n)).concat(E.getRow(e,n)).map((function(e){return t[e]}));return new Set(r)},testInput:function(e,t,n,r){var a=E.getGroupSet(e,t,n);return r>0&&r<=n*n&&(!a.has(r)||Array.from(new Set([E.getRow(e,n),E.getCol(e,n),E.getBox(e,n)].flat())).filter((function(e){return t[e]===r})))},autoComplete:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=new Set([E.getRow(e,n),E.getCol(e,n),E.getBox(e,n)].flat()),c=Array.from(a).map((function(e){return{set:E.getGroupSet(e,t,n),index:e}})).filter((function(e){return e.set.size===n*n&&0===t[e.index]}));if(console.log(c),c.length>0){var o=Object(A.a)(t),i=c.map((function(e){e.set.delete(0);for(var t=Array.from(e.set),r=Array(n*n).fill(!1),a=0;a<t.length;a++)r[t[a]-1]=!0;var i={index:e.index,value:r.findIndex((function(e){return!e}))+1};return o[i.index]=i.value,c.forEach((function(e){return e.set.add(i.value)})),i})),s=i.map((function(e){return E.autoComplete(e.index,o,n,[].concat(Object(A.a)(r),[e]))})),u=i.concat(s).flat();return console.log(u),Array.from(u)}return r}},G=E,_=(n(92),function(e){for(var t=Array.from(G.getGroupSet(e.index,e.values,e.n)),n=Array(e.n*e.n).fill(!1),a=0,c=t;a<c.length;a++){var o=c[a];o>0&&(n[o-1]=!0)}return Object(r.jsx)("div",{className:"hint-cell hint-cell-".concat(e.n),children:n.map((function(e,t){return e?Object(r.jsx)("div",{children:t+1},t):Object(r.jsx)("div",{children:"\xa0"},t)}))})}),U=(n(93),Object(l.b)((function(e){return{focus:e.game.focus,hintStyle:e.game.hintStyle}}),{setFocus:function(e){return{type:"SET_FOCUS",payload:{focus:e}}}})((function(e){var t=Math.sqrt(Math.sqrt(e.values.length)),n=function(e){var n="";return e%(t*t)===0&&(n+="left "),e%t===t-1&&(n+="right "),0===~~(e/(t*t))&&(n+="top "),~~(e/(t*t))%t===t-1&&(n+="bottom "),n},a=new Set(e.errors);return Object(r.jsx)("div",{className:"grid-container-".concat(t),children:e.values.map((function(c,o){return Object(r.jsxs)("div",{className:"grid-cell ".concat(n(o),"cell-size-").concat(t," player-").concat(e.players[o]," ").concat(a.has(o)?"cell-error":""),onClick:function(){return e.setFocus(o)},children:[a.has(o)?Object(r.jsx)("div",{className:"error-dot",children:Object(r.jsx)("div",{})}):null,e.focus===o||c>0?Object(r.jsx)(T,{player:e.players[o],value:c,index:o,n:t,handleTurn:e.handleTurn}):Object(r.jsx)(_,{index:o,n:t,values:e.values})]},o)}))})}))),I=function(e){return Object(r.jsxs)("div",{className:"score-card",children:[Object(r.jsx)("div",{className:"player-dot player-".concat(e.label," ").concat(e.isTurn?"isturn":null),children:"\xa0"}),Object(r.jsxs)("h4",{className:"player-label",children:[e.isPlayer===e.label?"You":"Them",":\xa0",e.sum]})]})},k=(n(94),function(e){var t=function(e,t){return e+t};return Object(r.jsxs)("div",{className:"game-sidebar-left",children:[Object(r.jsx)("h2",{children:"Score"}),Object(r.jsx)(I,{isTurn:1===e.isTurn,isPlayer:e.isPlayer,label:1,sum:e.players.filter((function(e){return 1===e})).reduce(t,0)}),Object(r.jsx)(I,{isTurn:2===e.isTurn,isPlayer:e.isPlayer,label:2,sum:e.players.filter((function(e){return 2===e})).reduce(t,0)/2}),e.errors.types.map((function(t,n){return function(t,n){switch(t){case"BAD_INPUT":return Object(r.jsxs)("div",{className:"error",children:["Move was blocked by ",e.errors.cells.length>1?"cells":"cell",":","\xa0",e.errors.cells.map((function(t,n){return Object(r.jsx)("span",{children:e.errors.cells.length-1!==n?t+",\xa0":t},n)}))]},n);case"NOT_TURN":return Object(r.jsx)("div",{className:"error",children:"It's not your turn"},n);case"BIG_NUM":return Object(r.jsxs)("div",{className:"error",children:["Number must be less than ",Math.sqrt(e.players.length)+1]},n);case"ZERO_NUM":return Object(r.jsx)("div",{className:"error",children:"Number must be greater than 0"},n);default:return Object(r.jsx)("div",{className:"error",children:"Error"},n)}}(t,n)}))]})}),P=(n(95),Object(l.b)((function(e){return{focus:e.game.focus,hintStyle:e.game.hintStyle,isPlayer:e.game.isPlayer}}),{setTurnArr:function(e){return{type:"SET_TURNS",payload:{turnArr:e}}}})((function(e){var t=Math.sqrt(Math.sqrt(e.board.size)),n=Object(a.useState)({values:Array(e.board.size).fill(0),players:Array(e.board.size).fill(0)}),o=Object(d.a)(n,2),i=o[0],s=o[1],u=Object(a.useState)({types:[],cells:[]}),l=Object(d.a)(u,2),j=l[0],b=l[1],f=Object(a.useState)(!e.conn||2===e.isPlayer),h=Object(d.a)(f,2),O=h[0],m=h[1],p=Object(a.useState)(!1),v=Object(d.a)(p,2),x=v[0],y=v[1],g=e.board.turnArr,N=g.length,S=N>0&&1===g[N-1].player?2:1;Object(a.useEffect)((function(){var n=G.initGrid(e.board.turnArr,t);if(n.values!==i.values&&s(n),e.conn)return e.conn.on("PLAYER_JOIN",(function(){m(!0)})),e.conn.on("USER_QUIT",(function(){y(!0)})),e.conn.on("UPDATE_TURN",(function(t){e.setTurnArr(t.turnArr)})),function(){e.conn.off("UPDATE_TURN"),e.conn.off("USER_QUIT"),e.conn.off("UPDATE_TURN")}}),[e.board,x]);return Object(r.jsx)("div",{className:"game-container",children:x?Object(r.jsxs)("div",{className:"pre-game",children:[Object(r.jsx)("h4",{children:" Uh oh, it looks like the other player quit the game! "}),Object(r.jsxs)("h4",{children:[" ","Currently there is no way for someone to rejoin a game, sorry :("]})]}):O?Object(r.jsxs)(c.a.Fragment,{children:[Object(r.jsx)(k,{players:i.players,errors:j,isTurn:S,isPlayer:e.isPlayer}),Object(r.jsx)(U,{errors:j.cells,players:i.players,values:i.values,handleTurn:function(n,r){if(e.conn){console.log(S);var a=G.testInput(n,i.values,t,r),c=e.isPlayer===S,o={types:[],cells:[]};if(!0===a&&c&&r>0&&r<=t*t){var s={gameID:e.board._id,player:e.isPlayer,index:n,value:r};e.conn.emit("ADD_TURN",s)}"boolean"!==typeof a&&0!==r&&(o={types:[].concat(Object(A.a)(o.types),["BAD_INPUT"]),cells:a}),c||o.types.push("NOT_TURN"),r<1&&o.types.push("ZERO_NUM"),r>t*t&&o.types.push("BIG_NUM"),b(o)}}}),Object(r.jsx)("div",{className:"game-sidebar-right",children:"\xa0"})]}):Object(r.jsxs)("div",{className:"pre-game",children:[Object(r.jsx)("h4",{children:"Waiting for player to join you"}),Object(r.jsxs)("h4",{children:["You're Game ID is: ",e.board._id," "]})]})})}))),R=(n(96),function(e){var t=Object(a.useState)(1),n=Object(d.a)(t,2),c=n[0],o=n[1],i=Object(a.useState)(e.board),s=Object(d.a)(i,2),u=s[0],l=s[1];Object(a.useEffect)((function(){var t=Object(S.a)(Object(S.a)({},e.board),{},{turnArr:e.board.turnArr.slice(0,c)});console.log(t),l(t)}),[c]);var j=function(t){c+t>e.board.turnArr.length?console.log("too much"):c+t<1?console.log("too little"):(console.log(t),o(c+t))};return Object(r.jsxs)("div",{className:"replay-container",children:[Object(r.jsx)(P,{board:u}),Object(r.jsxs)("div",{className:"replay-inputs",children:[Object(r.jsx)("button",{className:"fa fa-arrow-left",onClick:function(){return j(-1)}}),Object(r.jsx)("div",{children:"".concat(c," / ").concat(e.board.turnArr.length)}),Object(r.jsx)("button",{className:"fa fa-arrow-right",onClick:function(){return j(1)}})]})]})}),C=n(47),M=n.n(C),D={getGamesByUid:function(e){return M.a.get("/_replays",{params:{uid:e}})},getReplay:function(e){return M.a.get("/_replay",{params:{_id:e}})}},B=function(e){var t=Object(a.useState)([]),n=Object(d.a)(t,2),r=n[0],c=n[1];return Object(a.useEffect)((function(){D.getGamesByUid(e).then((function(e){var t=e.data.boards;c(t)})).catch((function(e){return console.log(e)}))}),[e]),r},z=function(){var e=Object(l.c)((function(e){return e.user.uid})),t=B(e||""),n=Object(a.useState)(null),c=Object(d.a)(n,2),o=c[0],i=c[1];if(null===e)return Object(r.jsx)("div",{children:"You need to be signed into an account to record games and access replays"});if(null!==o)return Object(r.jsx)(R,{board:o});return Object(r.jsxs)("div",{className:"menu-container",children:[Object(r.jsx)("div",{className:"menu-header",children:Object(r.jsx)("h1",{children:" Replays "})}),t.map((function(e){return Object(r.jsx)(j,{text:e,action:function(){return t=e,void D.getReplay(t).then((function(e){var t=e.data.board;i(t)})).catch((function(e){return console.log(e)}));var t}},e)}))]})},q=(n(114),Object(u.g)(Object(l.b)((function(e){return{conn:e.user.conn,board:e.game.board}}),{})((function(e){var t=Object(u.f)();return Object(a.useEffect)((function(){0===h.a.apps.length&&h.a.initializeApp({apiKey:"AIzaSyCagthgvuZJCzGOIIzgsRbUH9lgG1kq8EI",authDomain:"sugoku-3f76a.firebaseapp.com",projectId:"sugoku-3f76a",appId:"1:11174919362:web:9c8e6fb349fb0f6692cf5b"}),null!==e.board&&"/game"!==t.location.pathname&&t.push("/game")}),[e.board]),Object(r.jsx)("div",{className:"App",children:Object(r.jsxs)(u.c,{children:[Object(r.jsx)(u.a,{path:"/game",children:Object(r.jsx)(P,{board:e.board,conn:e.conn})}),Object(r.jsx)(u.a,{path:"/replay",children:Object(r.jsx)(z,{})}),Object(r.jsx)(u.a,{path:"/create",children:Object(r.jsx)(g,{})}),Object(r.jsx)(u.a,{path:"/join",children:Object(r.jsx)(N,{})}),Object(r.jsx)(u.a,{exact:!0,path:"/",children:Object(r.jsx)(y,{})})]})})})))),J=n(20),L=n(73),H=n(74),F={string:"",conn:n.n(H)()("wss://sudoku-chess2.herokuapp.com/",{transports:["websocket"]}),uid:null},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TEST":var n=t.payload.string;return Object(S.a)(Object(S.a)({},e),{},{string:n});case"SET_UID":var r=t.payload.uid;return Object(S.a)(Object(S.a)({},e),{},{uid:r});default:return Object(S.a)({},e)}},W={board:null,target:0,hintStyle:"default",focus:0,isPlayer:void 0},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_BOARD":var n=t.payload,r=n.board,a=n.isPlayer;return Object(S.a)(Object(S.a)({},e),{},{board:r,isPlayer:a});case"SET_FOCUS":var c=t.payload.focus;return Object(S.a)(Object(S.a)({},e),{},{focus:c});case"SET_TURNS":var o=t.payload.turnArr;return Object(S.a)(Object(S.a)({},e),{},{board:Object(S.a)(Object(S.a)({},e.board),{},{turnArr:o})});default:return Object(S.a)({},e)}},K=Object(J.c)({user:Y,game:Z}),Q=Object(J.d)(K,Object(J.a)(L.a));i.a.render(Object(r.jsx)(l.a,{store:Q,children:Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(s.a,{children:Object(r.jsx)(q,{})})})}),document.getElementById("root"))},84:function(e,t,n){},86:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){}},[[144,1,2]]]);
//# sourceMappingURL=main.2f4d8229.chunk.js.map